
import { WebSocket, WebSocketServer } from 'ws';

const wss = new WebSocketServer({ port: 3000 });

wss.on('connection', function connection(ws) {
   

console.log('cliente conectado')

  ws.on('error', console.error);

  ws.on('message', function message(data) {
    console.log('desde el cliente: %s', data);
    const dataObject = {
        type: 'custom-message',
        payload: data.toString()
    }

    const payload = JSON.stringify(dataObject)
   // ws.send(JSON.stringify(payload))

//* Todos - incluytente
//    wss.clients.forEach(function each(client) {
//     if (client.readyState === WebSocket.OPEN) {
//       client.send(payload, { binary: false });
//     }
//   });


  //* todos excluyente
  wss.clients.forEach(function each(client) {
    if (client !== ws && client.readyState === WebSocket.OPEN) {
      client.send(payload, { binary: false });
    }
  });
  });

//   ws.send(`hola desde el servidor 
    
//     ──▄▄▄▄▄███████████████████▄▄▄▄▄──────
// ────▄██████████▀▀▀▀▀▀▀▀▀▀██████▀████▄────
// ──▄██▀████████▄─────────────▀▀████─▀██▄──
// ─▀██▄▄██████████████████▄▄▄─────────▄██▀─
// ───▀█████████████████████████▄────▄██▀───
// ─────▀████▀▀▀▀▀▀▀▀▀▀▀▀█████████▄▄██▀─────
// ───────▀███▄──────────────▀██████▀───────
// ─────────▀██████▄─────────▄████▀─────────
// ────────────▀█████▄▄▄▄▄▄▄███▀────────────
// ──────────────▀████▀▀▀████▀──────────────
// ────────────────▀███▄███▀────────────────
// ───────────────────▀█▀───────────────────
//     `);


    ws.on('close', () => {
        console.log('Cliente desconectado')
    })
});


//console.log('server on http://localhost:3000')

// console.log(`

// ────────────────────▄▄▄▄
// ────────────────▄▄█▀▀──▀▀█▄
// ─────────────▄█▀▀─────────▀▀█▄
// ────────────▄█▀──▄▄▄▄▄▄──────▀█
// ────────────█───█▌────▀▀█▄─────█
// ────────────█──▄█────────▀▀▀█──█
// ────────────█──█──▀▀▀──▀▀▀▄─▐──█
// ────────────█──▌────────────▐──█
// ────────────█──▌─▄▀▀▄───────▐──█
// ───────────█▀▌█──▄▄▄───▄▀▀▄─▐──█
// ───────────▌─▀───█▄█▌─▄▄▄────█─█
// ───────────▌──────▀▀──█▄█▌────█
// ───────────█───────────▀▀─────▐
// ────────────█──────▌──────────█
// ────────────██────█──────────█
// ─────────────█──▄──█▄█─▄────█
// ─────────────█──▌─▄▄▄▄▄─█──█
// ─────────────█─────▄▄──▄▀─█
// ─────────────█▄──────────█
// ─────────────█▀█▄▄──▄▄▄▄▄█▄▄▄▄▄
// ───────────▄██▄──▀▀▀█─────────█
// ──────────██▄─█▄────█─────────█
// ───▄▄▄▄███──█▄─█▄───█─────────██▄▄▄
// ▄█▀▀────█────█──█▄──█▓▓▓▓▓▓▓▓▓█───▀▀▄
// █──────█─────█───████▓▓▓▓▓▓▓▓▓█────▀█
// █──────█─────█───█████▓▓▓▓▓▓▓█──────█
// █─────█──────█───███▀▀▀▀█▓▓▓█───────█
// █────█───────█───█───▄▄▄▄████───────█
// █────█───────█──▄▀───────────█──▄───█
// █────█───────█─▄▀─────█████▀▀▀─▄█───█
// █────█───────█▄▀────────█─█────█────█
// █────█───────█▀───────███─█────█────█
// █─────█────▄█▀──────────█─█────█────█
// █─────█──▄██▀────────▄▀██─█▄───█────█
// █────▄███▀─█───────▄█─▄█───█▄──█────█
// █─▄██▀──█──█─────▄███─█─────█──█────█
// ██▀────▄█───█▄▄▄█████─▀▀▀▀█▀▀──█────█
// █──────█────▄▀──█████─────█────▀█───█
// ───────█──▄█▀───█████─────█─────█───█
// ──────▄███▀─────▀███▀─────█─────█───█
// ─────────────────────────────────────
// ▀█▀─█▀▄─█─█─█▀────▄▀▀─▀█▀─▄▀▄─█▀▄─█─█
// ─█──█▄▀─█─█─█▀────▀▀█──█──█─█─█▄▀─█▄█
// ─▀──▀─▀─▀▀▀─▀▀────▀▀───▀───▀──▀─▀─▄▄█
// ─────────────────────────────────────



//     `);
